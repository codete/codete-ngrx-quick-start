"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[746],{17746:(he,U,d)=>{d.r(U),d.d(U,{TasksAppModule2:()=>Ke});var c=d(42520),s=d(2613),u=d(61038),E=d(26110),p=d(66546),_=d(93263),k=d(76629),z=d(67299),J=d(99443),i=d(34299),l=d(22975),Y=d(18631),X=d(11512),K=d(70655),T=d(56657),f=d(44441),g=d(81472),S=d(50617);let V=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-tasks"]],decls:1,vars:0,template:function(e,n){1&e&&c._UZ(0,"app-tasks-engine")},directives:[g.TasksEngineComponent],encapsulation:2}),t})(),q=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-tasks-app"]],decls:1,vars:0,template:function(e,n){1&e&&c._UZ(0,"app-tasks")},directives:[V],styles:[""]}),t})();const C=(0,s.PH)("[tasks] INIT"),P=(0,s.PH)("[tasks] TOOGLE_SUBTASKS_MENU",(0,s.Ky)()),O=(0,s.PH)("[tasks] FETCH_TASKS"),M=(0,s.PH)("[tasks] FETCH_TASKS_SUCCESS",(0,s.Ky)()),ee=(0,s.PH)("[tasks] FETCH_TASKS_ERROR",(0,s.Ky)()),b=(0,s.PH)("[tasks] ADD_TASK",(0,s.Ky)()),R=(0,s.PH)("[tasks] ADD_TASK_SUCCESS",(0,s.Ky)()),te=(0,s.PH)("[tasks] ADD_TASK_ERROR",(0,s.Ky)()),A=((0,s.PH)("[tasks] UPDATE_TASK",(0,s.Ky)()),(0,s.PH)("[tasks] UPDATE_TASK_SUCCESS",(0,s.Ky)())),se=(0,s.PH)("[tasks] UPDATE_TASK_ERROR",(0,s.Ky)()),y=(0,s.PH)("[tasks] DELETE_TASK",(0,s.Ky)()),m=(0,s.PH)("[tasks] DELETE_TASK_SUCCESS",(0,s.Ky)()),ne=(0,s.PH)("[tasks] DELETE_TASK_ERROR",(0,s.Ky)()),re=(0,s.Lq)({tasks:[]},(0,s.on)(M,(t,{tasks:o})=>Object.assign(Object.assign({},t),{tasks:l.cloneDeep(o)})),(0,s.on)(P,(t,{task:o})=>{const e=l.cloneDeep(t);return e.tasks=e.tasks.map(n=>(n.selected=n.id===o.id&&!o.selected,n)),Object.assign(Object.assign({},t),e)}),(0,s.on)(R,(t,{task:o})=>{const e=l.cloneDeep(t);return e.tasks.push(o),Object.assign(Object.assign({},t),e)}),(0,s.on)(A,(t,{task:o})=>{const e=l.cloneDeep(t);return e.tasks=e.tasks.map(n=>n.id===o.id?l.merge(n,o):n),Object.assign(Object.assign({},t),e)}),(0,s.on)(m,(t,{task:o})=>{const e=l.cloneDeep(t);return e.tasks=e.tasks.filter(n=>n.id!==o.id),Object.assign(Object.assign({},t),e)})),v="tasks";let B=(()=>{class t{constructor(e){this.httpClient=e}getAll(){return T.ZH.isWebSQL?S.iQ.ctrl.getAll().received.observable.pipe((0,u.U)(e=>e.body.json)):this.httpClient.get(`${S.ho}/${v}/models`)}create(e){return T.ZH.isWebSQL?S.iQ.ctrl.create(e).received.observable.pipe((0,u.U)(n=>n.body.json)):this.httpClient.post(`${S.ho}/${v}/model`,e)}update(e){return T.ZH.isWebSQL?S.iQ.ctrl.updateById(null==e?void 0:e.id,e).received.observable.pipe((0,u.U)(n=>n.body.json)):this.httpClient.put(`${S.ho}/${v}/model/${e.id}`,e)}delete(e){return T.ZH.isWebSQL?S.iQ.ctrl.deleteById(null==e?void 0:e.id).received.observable.pipe((0,u.U)(n=>n.body.json)):this.httpClient.delete(`${S.ho}/${v}/model/${e.id}`)}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(f.eN))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac}),t})(),L=(()=>{class t{constructor(e,n){this.actions$=e,this.service=n,this.init=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(C),(0,E.w)(()=>(0,p.of)(O())))),this.fetchTasks=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(O),(0,E.w)(()=>this.service.getAll().pipe((0,u.U)(a=>M({tasks:a})),(0,_.K)(a=>(0,p.of)(ee({error:a}))))))),this.addTask=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(b),(0,k.z)(a=>this.service.create(a.task).pipe((0,u.U)(r=>R({task:r})),(0,_.K)(r=>(0,p.of)(te({error:r}))))))),this.updateTask=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(A),(0,k.z)(a=>this.service.update(a.task).pipe((0,u.U)(r=>A({task:r})),(0,_.K)(r=>(0,p.of)(se({error:r}))))))),this.deleteTask=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(y),(0,k.z)(a=>this.service.delete(a.task).pipe((0,u.U)(r=>m({task:r})),(0,_.K)(r=>(0,p.of)(ne({error:r})))))))}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(i.eX),c.LFG(B))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac}),t})();const H="tasks",ie=(0,s.ZF)(H),ae=(0,s.P1)(ie,t=>t.tasks),$="subtasks",ce=(0,s.ZF)($),de=(0,s.P1)(ce,t=>t.subtasks),F=(0,s.PH)("[tasks] FETCH_SUBTASKS",(0,s.Ky)()),W=(0,s.PH)("[tasks] FETCH_SUBTASKS_SUCCESS",(0,s.Ky)()),Se=(0,s.PH)("[tasks] FETCH_SUBTASKS_ERROR",(0,s.Ky)()),j=(0,s.PH)("[tasks] ADD_SUBTASK",(0,s.Ky)()),I=(0,s.PH)("[tasks] ADD_SUBTASK_SUCCESS",(0,s.Ky)()),ue=(0,s.PH)("[tasks] ADD_SUBTASK_ERROR",(0,s.Ky)()),G=(0,s.PH)("[tasks] UPDATE_SUBTASK",(0,s.Ky)()),w=(0,s.PH)("[tasks] UPDATE_SUBTASK_SUCCESS",(0,s.Ky)()),le=(0,s.PH)("[tasks] UPDATE_SUBTASK_ERROR",(0,s.Ky)()),Q=(0,s.PH)("[tasks] DELETE_SUBTASK",(0,s.Ky)()),x=(0,s.PH)("[tasks] DELETE_SUBTASK_SUCCESS",(0,s.Ky)()),pe=(0,s.PH)("[tasks] DELETE_SUBTASK_ERROR",(0,s.Ky)());let N=(()=>{class t{constructor(e){this.store=e}helloWorld(){return"Hello from standard ngrx application"}title(){return(0,p.of)("TASKS (standard ngrx application)")}get isProcessingSubtaskRequestSelector(){return(0,p.of)(!1)}get isProcessingTaskRequestSelector(){return(0,p.of)(!1)}allTasksSelector(){return this.store.select(ae)}allSubtasks(e){return this.store.select(de)}synchonizationSateSelector(){return(0,p.of)("idle")}initAction(){return(0,K.mG)(this,void 0,void 0,function*(){this.store.dispatch(C())})}addTaskAction(e,n){return(0,K.mG)(this,void 0,void 0,function*(){"Enter"===e.code&&(n.newTaskModel&&this.store.dispatch(b({task:{name:n.newTaskModel}})),n.newTaskModel="")})}removeTaskAction(e){this.store.dispatch(y({task:{id:e}}))}onSaveTaskAction(e,n){n=l.cloneDeep(n),l.merge(n,e),this.store.dispatch(A({task:n}))}fetchSubtaskAction(e){return(0,K.mG)(this,void 0,void 0,function*(){this.store.dispatch(F({taskId:e}))})}addSubTaskAction(e,n){if(e.stopImmediatePropagation(),e.stopPropagation(),"Enter"===e.code&&n.tempSubtask){const a=S.Mp.from({name:n.tempSubtask,taskId:n.taskId}),r=l.cloneDeep(a);r&&Object.keys(r).length>0&&this.store.dispatch(j({subtask:r})),n.tempSubtask=""}}removeSubTaskAction(e){this.store.dispatch(Q({subtask:e}))}onSaveSubTaskAction(e,n){this.store.dispatch(G({subtask:l.merge(l.clone(n),e)}))}toogleSubtasksAction(e,n,a){a.toogled=n,setTimeout(()=>{var r,h;n.selected?null===(h=a.drawer)||void 0===h||h.close():null===(r=a.drawer)||void 0===r||r.open(),this.store.dispatch(P({task:n})),e.stopPropagation()})}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(s.yh))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac}),t})();const Te=(0,s.Lq)({subtasks:[]},(0,s.on)(W,(t,{subtasks:o})=>Object.assign(Object.assign({},t),{subtasks:l.cloneDeep(o)})),(0,s.on)(I,(t,{subtask:o})=>{const e=l.cloneDeep(t);return e.subtasks.push(o),Object.assign(Object.assign({},t),e)}),(0,s.on)(w,(t,{subtask:o})=>{const e=l.cloneDeep(t);return e.subtasks=e.subtasks.map(n=>n.id===o.id?l.merge(n,o):n),Object.assign(Object.assign({},t),e)}),(0,s.on)(x,(t,{subtask:o})=>{const e=l.cloneDeep(t);return e.subtasks=e.subtasks.filter(n=>n.id!==o.id),Object.assign(Object.assign({},t),e)})),D="subtasks";let Z=(()=>{class t{constructor(e){this.httpClient=e}getAll(e){return T.ZH.isWebSQL?S.Mp.ctrl.getAll(e).received.observable.pipe((0,u.U)(n=>n.body.json)):this.httpClient.get(`${S.ho}/${D}/models?taskId=${e}`)}create(e){return T.ZH.isWebSQL?S.Mp.ctrl.create(e).received.observable.pipe((0,u.U)(n=>n.body.json)):this.httpClient.post(`${S.ho}/${D}/model`,e)}update(e){return T.ZH.isWebSQL?S.Mp.ctrl.updateById(null==e?void 0:e.id,e).received.observable.pipe((0,u.U)(n=>n.body.json)):this.httpClient.put(`${S.ho}/${D}/model/${e.id}`,e)}delete(e){return T.ZH.isWebSQL?S.Mp.ctrl.deleteById(null==e?void 0:e.id).received.observable.pipe((0,u.U)(n=>n.body.json)):this.httpClient.delete(`${S.ho}/${D}/model/${e.id}`)}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(f.eN))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac}),t})(),Ee=(()=>{class t{constructor(e,n){this.actions$=e,this.service=n,this.fetchSubTasks=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(F),(0,E.w)(a=>this.service.getAll(a.taskId).pipe((0,u.U)(r=>W({subtasks:r})),(0,_.K)(r=>(0,p.of)(Se({error:r}))))))),this.addSubTask=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(j),(0,E.w)(a=>this.service.create(a.subtask).pipe((0,u.U)(r=>I({subtask:r})),(0,_.K)(r=>(0,p.of)(ue({error:r}))))))),this.updateSubTask=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(G),(0,E.w)(a=>this.service.update(a.subtask).pipe((0,u.U)(r=>w({subtask:r})),(0,_.K)(r=>(0,p.of)(le({error:r}))))))),this.deleteSubTask=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(Q),(0,E.w)(a=>this.service.delete(a.subtask).pipe((0,u.U)(r=>x({subtask:r})),(0,_.K)(r=>(0,p.of)(pe({error:r})))))))}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(i.eX),c.LFG(Z))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac}),t})(),fe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({providers:[Z],imports:[[f.JF,s.Aw.forFeature($,Te),i.sQ.forFeature([Ee])]]}),t})(),Ae=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({providers:[L,B,N],imports:[[g.TasksEngineModule.forRoot({customEngineService:N}),f.JF,s.Aw.forFeature(H,re),i.sQ.forFeature([L]),fe]]}),t})();const De=(0,s.Lq)({loggedUser:""}),ke=[{path:"",component:q}];let Ke=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[z.ez,Ae,s.Aw.forRoot(De,{}),i.sQ.forRoot([]),Y.Qi.forRoot(),X.FT.instrument({}),J.Bz.forChild(ke)]]}),t})()}}]);